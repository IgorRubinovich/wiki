#!/usr/bin/env node

require('coffee-script');
var express = require('express'),
  sharejs = require('../src'),
  hat = require('hat').rack(32, 36);

var connect = require('connect'),
    sharejs = require('share').server;

var server = connect(
      connect.logger(),
      connect.static(__dirname + '/public')
    );
var options = require("./options") //{db: {type: 'none'}}; // See docs for options. {type: 'redis'} to enable persistance.

var server = express();
server.use(express.static(__dirname + '/../examples'));


// Attach the sharejs REST and Socket.io interfaces to the server
sharejs.attach(server, options);

server.listen(8000, function(){
    console.log('Server running at http://127.0.0.1:8000/');
});

var wiki = require('../examples/_wiki');
server.get('/wiki/?', function(req, res, next) {
  res.writeHead(301, {location: '/wiki/Main'});
  res.end();
});
server.get('/wiki/:docName', function(req, res, next) {
  var docName;
  docName = req.params.docName;
  wiki(docName, server.model, res, next);
});


